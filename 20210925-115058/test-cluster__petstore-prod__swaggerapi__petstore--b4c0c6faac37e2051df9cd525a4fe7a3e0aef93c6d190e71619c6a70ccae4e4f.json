{"appname":"petstore","email":"clusterscannertest@sda.se","environment":"test-cluster","image":"swaggerapi/petstore:1.0.3","imageHash":"b4c0c6faac37e2051df9cd525a4fe7a3e0aef93c6d190e71619c6a70ccae4e4f","imageTag":"1.0.3","namespace":"petstore-prod","notificationRequired":true,"scanResults":[{"scan-baseimage-lifetime":{"age":744,"buildDate":"2019-09-11T23:27:26.526904575Z","cachedUsedAt":"2021-09-25 11:51:30.617496268+00:00","finding":true,"finishedAt":"2021-09-25 11:06:19.400621402+00:00","imageType":"BaseImage","infoText":"BaseImage is 744 days too old","maxAge":14,"startedAt":"2021-09-25 11:06:14.401527386+00:00","status":"completed"}},{"scan-distroless":{"cachedUsedAt":"2021-09-25 11:51:32.264817633+00:00","finding":true,"finishedAt":"2021-09-25 11:06:17.147966048+00:00","infoText":"Image has shell executables and therefore most likely is not distroless","shells":["bin/sh","bin/bash","bin/dash"],"startedAt":"2021-09-25 11:06:17.054327053+00:00","status":"completed"}},{"scan-lifetime":{"age":710,"buildDate":"2019-10-16T08:26:52.757799248Z","cachedUsedAt":"2021-09-25 11:51:29.241155597+00:00","finding":true,"finishedAt":"2021-09-25 11:06:27.198692349+00:00","imageType":"Image","infoText":"Image is 710 days too old","maxAge":14,"startedAt":"2021-09-25 11:06:19.762890778+00:00","status":"completed"}},{"scan-malware":{"cachedUsedAt":"2021-09-25 11:51:26.166590601+00:00","finishedAt":"2021-09-25 11:06:15.776524376+00:00","infoText":"Skipping scan-malware due to configuration in json from image collector","startedAt":"2021-09-25 11:06:15.767061288+00:00","status":"skipped"}},{"scan-new-version":{"cachedUsedAt":"2021-09-25 11:51:27.801351895+00:00","finishedAt":"2021-09-25 11:06:21.105845913+00:00","infoText":"Skipping scan-new-version due to configuration in json from image collector","startedAt":"2021-09-25 11:06:21.098342579+00:00","status":"skipped"}},{"scan-runasroot":{"cachedUsedAt":"2021-09-25 11:51:26.944915497+00:00","finding":true,"finishedAt":"2021-09-25 11:06:16.803732613+00:00","infoText":"Image is potentially running as root","startedAt":"2021-09-25 11:06:13.043866954+00:00","status":"completed"}}],"scm_source_branch":"TODO","slack":"#security-notifications-test","team":"security-test","uploadResults":[{"ddGenericUpload":{"ddLink":"http://192.168.178.55:8081//test/1084","errors":[],"finding":true,"findings":[{"active":true,"description":"\nBaseImage is 744 days too old\nBaseImage swaggerapi/petstore:1.0.3\nCluster test-cluster\nNamespace petstore-prod","duplicate":false,"duplicateFinding":null,"endpoints":[36],"falsePositive":false,"foundBy":[120],"id":29929,"impact":"","mitigation":"","numericalSeverity":"S2","severity":"Medium","test":1076,"title":"BaseImage Age > 14 Days","verified":false},{"active":true,"description":"\nImage is 710 days too old\nImage swaggerapi/petstore:1.0.3\nCluster test-cluster\nNamespace petstore-prod","duplicate":false,"duplicateFinding":null,"endpoints":[36],"falsePositive":false,"foundBy":[120],"id":29931,"impact":"","mitigation":"","numericalSeverity":"S2","severity":"Medium","test":1076,"title":"Image Age > 14 Days","verified":false},{"active":true,"description":"\nImage has shell executables and therefore most likely is not distroless\nImage swaggerapi/petstore:1.0.3\nCluster test-cluster\nNamespace petstore-prod","duplicate":false,"duplicateFinding":null,"endpoints":[36],"falsePositive":false,"foundBy":[120],"id":29344,"impact":"Relevance\nA normal container image contains, in addition to the actual application, many components that ensure the functionality. However, these components also contain parts that are not necessary for the operation of the application. These parts may contain potential vulnerabilities or could otherwise be used for abuse. In order to avoid the possible threats, the images are checked for components that are not required and a warning is given.\n\nResponse\nUse the following treatments on issues:\n\n\nAvoidance\nDo not use the image in production.\n\n\nMitigation\nIf the scan detects that the image has not been cleaned of parts that are unnecessary for the operation of the image, it is recommended to build container images according to distroless.\n\n\nAcceptance\nAs the risk owner of the application, you can accept the risks coming by the usage of a non-distroless image. A temporary acceptance is recommended, to be reminded of the risk.\n\n\nFalse Positive\nIn case a shell is needed for the application and distroless is used, the finding can be marked as false positive.\n\n","mitigation":"Response\nUse the following treatments on issues:\n\n\nAvoidance\nDo not use the image in production.\n\n\nMitigation\nIf the scan detects that the image has not been cleaned of parts that are unnecessary for the operation of the image, it is recommended to build container images according to distroless.\n\n\nAcceptance\nAs the risk owner of the application, you can accept the risks coming by the usage of a non-distroless image. A temporary acceptance is recommended, to be reminded of the risk.\n\n\nFalse Positive\nIn case a shell is needed for the application and distroless is used, the finding can be marked as false positive.\n\n","numericalSeverity":"S2","severity":"Medium","test":1031,"title":"No Distroless Used","verified":false},{"active":true,"description":"\n\nImage swaggerapi/petstore:1.0.3\nCluster test-cluster\nNamespace petstore-prod","duplicate":false,"duplicateFinding":null,"endpoints":[36],"falsePositive":false,"foundBy":[120],"id":28547,"impact":"","mitigation":"","numericalSeverity":"S2","severity":"Medium","test":987,"title":"Image Potentially Running as Root","verified":false}],"finishedAt":"2021-09-25T11:51:57Z","infoText":"Potential unhandled vulnerabilities or misconfigurations found in image","scanType":"Generic","startedAt":"2021-09-25T11:51:51Z","status":"completed"}},{"ddDependencyCheckUpload":{"ddLink":"http://192.168.178.55:8081//test/1083","errors":[],"finding":true,"findings":[{"description":"OWASP Dependency Check found some findings, please check DefectDojo","title":"Dependency Check Finding"}],"finishedAt":"2021-09-25T11:51:54Z","infoText":"Potential unhandled known vulnerabilities found in image","scanType":"Dependency Check","startedAt":"2021-09-25T11:51:31Z","status":"completed"}}]}
